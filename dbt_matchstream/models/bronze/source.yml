version: 2

sources:
  - name: bronze
    schema: bronze
    description: >
      Raw CDC data ingested from Debezium/Kafka.
      Tables contain full CDC metadata and must not be transformed in-place.

    tables:
      - name: actions_cdc
        description: >
          Raw CDC stream of user swipe actions (like/dislike).
          One record per CDC event.
        columns:
          - name: event_id
            description: Unique Debezium event identifier
            tests: [not_null]
          - name: op
            description: >
              CDC operation type:
              c = create, u = update, d = delete, r = snapshot
            tests:
              - not_null
              - accepted_values:
                  values: ['c', 'u', 'd', 'r']
          - name: cdc_ts_ms
            description: CDC event timestamp in milliseconds since epoch
            tests: [not_null]
          - name: source_db
            description: Source database name
          - name: source_schema
            description: Source schema name
          - name: source_table
            description: Source table name
          - name: source_tx_id
            description: Source transaction identifier
          - name: user_id
            description: User performing the action
            tests: [not_null]
          - name: target_id
            description: User being acted upon
            tests: [not_null]
          - name: action
            description: Swipe action type
            tests:
              - not_null
              - accepted_values:
                  values: ['like', 'dislike']
          - name: created_at
            description: Original action creation timestamp
          - name: ingested_at
            description: Timestamp when record was ingested into Bronze
            tests: [not_null]

      - name: matches_cdc
        description: >
          Raw CDC stream of mutual matches between users.
          One record per CDC event.
        columns:
          - name: event_id
            description: Unique Debezium event identifier
            tests: [not_null]
          - name: op
            description: CDC operation type
            tests:
              - not_null
              - accepted_values:
                  values: ['c', 'u', 'd', 'r']
          - name: cdc_ts_ms
            description: CDC event timestamp in milliseconds since epoch
            tests: [not_null]
          - name: source_db
            description: Source database name
          - name: source_schema
            description: Source schema name
          - name: source_table
            description: Source table name
          - name: source_tx_id
            description: Source transaction identifier
          - name: user1
            description: First user in the match
            tests: [not_null]
          - name: user2
            description: Second user in the match
            tests: [not_null]
          - name: created_at
            description: Timestamp when the match was created
          - name: ingested_at
            description: Timestamp when record was ingested into Bronze
            tests: [not_null]

      - name: users_cdc
        description: >
          Raw CDC stream of user records.
          Includes PII and profile metadata.
        columns:
          - name: event_id
            description: Unique Debezium event identifier
            tests: [not_null]
          - name: op
            description: CDC operation type
            tests:
              - not_null
              - accepted_values:
                  values: ['c', 'u', 'd', 'r']
          - name: cdc_ts_ms
            description: CDC event timestamp in milliseconds since epoch
            tests: [not_null]
          - name: source_db
            description: Source database name
          - name: source_schema
            description: Source schema name
          - name: source_table
            description: Source table name
          - name: source_tx_id
            description: Source transaction identifier
          - name: id
            description: Primary user identifier
            tests: [not_null]
          - name: user_id
            description: Public user UUID
            tests: [not_null]
          - name: gender
            description: User gender
          - name: first_name
            description: User first name
          - name: last_name
            description: User last name
          - name: email
            description: User email address
          - name: password
            description: Hashed password (PII â€“ do not expose beyond Bronze)
          - name: dob_days
            description: Date of birth expressed in days since epoch
          - name: phone
            description: User phone number
          - name: cell
            description: User cell number
          - name: picture_large
            description: URL to large profile picture
          - name: picture_medium
            description: URL to medium profile picture
          - name: picture_thumbnail
            description: URL to thumbnail profile picture
          - name: city
            description: User city
          - name: state
            description: User state name
          - name: state_id
            description: State identifier
          - name: postcode
            description: Postal code
          - name: latitude
            description: Latitude coordinate
          - name: longitude
            description: Longitude coordinate
          - name: created_at
            description: Timestamp when user was created
          - name: ingested_at
            description: Timestamp when record was ingested into Bronze
            tests: [not_null]
