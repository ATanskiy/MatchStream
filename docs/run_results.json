{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-12-16T22:00:28.658970Z", "invocation_id": "e4938e0c-549b-475f-8de4-4c26754bd1fc", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.523256Z", "completed_at": "2025-12-16T22:00:27.588253Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.598242Z", "completed_at": "2025-12-16T22:00:27.598269Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10516548156738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.dim_states", "compiled": true, "compiled_code": "\n\n-- 1. \u0411\u0435\u0440\u0451\u043c \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0435 \u0448\u0442\u0430\u0442\u044b\nWITH base AS (\n    SELECT DISTINCT\n        state AS state_name,\n        state_id AS state_name_id,\n        ingested_at\n    FROM bronze.users_cdc\n    WHERE state IS NOT NULL\n),\n\n-- 2. \u0414\u0435\u043b\u0430\u0435\u043c \u0434\u0435\u0442\u0435\u0440\u043c\u0438\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a \u0448\u0442\u0430\u0442\u043e\u0432\nordered AS (\n    SELECT\n        state_name,\n        state_name_id,\n        MAX(ingested_at) AS last_ingested_at\n    FROM base\n    GROUP BY state_name, state_name_id\n),\n\n-- 3. \u041d\u0430\u0437\u043d\u0430\u0447\u0430\u0435\u043c serial-like ID\nwith_ids AS (\n    SELECT\n        ROW_NUMBER() OVER (ORDER BY state_name_id) AS state_id,\n        state_name,\n        state_name_id,\n        last_ingested_at\n    FROM ordered\n)\n\nSELECT *\nFROM with_ids", "relation_name": "silver.dim_states", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.532976Z", "completed_at": "2025-12-16T22:00:27.590112Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.600855Z", "completed_at": "2025-12-16T22:00:27.600873Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10572600364685059, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.fct_actions", "compiled": true, "compiled_code": "\n\nWITH max_loaded AS (\n\n    \n        SELECT MAX(cdc_ts_ms) AS max_cdc_ts\n        FROM silver.fct_actions\n    \n\n),\n\nranked AS (\n\n    SELECT\n        event_id,\n        user_id,\n        target_id,\n        action,\n        created_at,\n        ingested_at AS ingested_at_bronze,\n        cdc_ts_ms,\n\n        ROW_NUMBER() OVER (\n            PARTITION BY user_id, target_id\n            ORDER BY cdc_ts_ms DESC\n        ) AS rn\n\n    FROM bronze.actions_cdc\n    CROSS JOIN max_loaded\n\n    WHERE op != 'd'\n      AND cdc_ts_ms > max_loaded.max_cdc_ts\n)\n\nSELECT\n    event_id,\n    user_id,\n    target_id,\n    action,\n    created_at,\n    ingested_at_bronze,\n    cdc_ts_ms\n\nFROM ranked\nWHERE rn = 1", "relation_name": "silver.fct_actions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.540981Z", "completed_at": "2025-12-16T22:00:27.591215Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.602901Z", "completed_at": "2025-12-16T22:00:27.602909Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10602355003356934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.fct_matches", "compiled": true, "compiled_code": "\n\nWITH max_loaded AS (\n\n    \n        SELECT MAX(cdc_ts_ms) AS max_cdc_ts\n        FROM silver.fct_matches\n    \n\n),\n\nnormalized AS (\n\n    SELECT\n        event_id,\n        LEAST(user1, user2)    AS user1,\n        GREATEST(user1, user2) AS user2,\n        created_at,\n        ingested_at AS ingested_at_bronze,\n        cdc_ts_ms,\n\n        ROW_NUMBER() OVER (\n            PARTITION BY\n                LEAST(user1, user2),\n                GREATEST(user1, user2)\n            ORDER BY cdc_ts_ms DESC\n        ) AS rn\n\n    FROM bronze.matches_cdc\n    CROSS JOIN max_loaded\n\n    WHERE op != 'd'\n      AND cdc_ts_ms > max_loaded.max_cdc_ts\n)\n\nSELECT\n    user1,\n    user2,\n    created_at,\n    ingested_at_bronze,\n    cdc_ts_ms\n\nFROM normalized\nWHERE rn = 1", "relation_name": "silver.fct_matches", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.545502Z", "completed_at": "2025-12-16T22:00:27.592097Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.604836Z", "completed_at": "2025-12-16T22:00:27.604844Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10654354095458984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.users_contact", "compiled": true, "compiled_code": "\n\nWITH src AS (SELECT * FROM bronze.users_cdc)\n\nSELECT\n    user_id,\n    email,\n    phone,\n    cell,\n    ingested_at AS ingested_at_bronze\nFROM src", "relation_name": "silver.users_contact", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.549246Z", "completed_at": "2025-12-16T22:00:27.592523Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.606710Z", "completed_at": "2025-12-16T22:00:27.606717Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.10680079460144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.users_metadata", "compiled": true, "compiled_code": "\n\nWITH src AS (SELECT * FROM bronze.users_cdc)\n\nSELECT\n    user_id,\n    CAST(created_at AS TIMESTAMP) AS created_at,\n    password,\n    ingested_at AS ingested_at_bronze\nFROM src", "relation_name": "silver.users_metadata", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.553040Z", "completed_at": "2025-12-16T22:00:27.593684Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.608397Z", "completed_at": "2025-12-16T22:00:27.608405Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.10677981376647949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.users_picture", "compiled": true, "compiled_code": "\n\nWITH src AS (SELECT * FROM bronze.users_cdc)\n\nSELECT\n    user_id,\n    picture_large,\n    picture_medium,\n    picture_thumbnail,\n    ingested_at AS ingested_at_bronze\nFROM src", "relation_name": "silver.users_picture", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.556717Z", "completed_at": "2025-12-16T22:00:27.597316Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.610141Z", "completed_at": "2025-12-16T22:00:27.610149Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.10692644119262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_accepted_values_bronze_actions_cdc_action__like__dislike.c7fcd3d348", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        action as value_field,\n        count(*) as n_records\n\n    from bronze.actions_cdc\n    group by action\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'like','dislike'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.566022Z", "completed_at": "2025-12-16T22:00:27.599277Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.613370Z", "completed_at": "2025-12-16T22:00:27.613378Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.10905027389526367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_accepted_values_bronze_actions_cdc_op__c__u__d__r.7b8036a012", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        op as value_field,\n        count(*) as n_records\n\n    from bronze.actions_cdc\n    group by op\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'c','u','d','r'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.579434Z", "completed_at": "2025-12-16T22:00:27.601772Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.616830Z", "completed_at": "2025-12-16T22:00:27.616839Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.10733366012573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_accepted_values_bronze_users_cdc_op__c__u__d__r.4382e1018b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        op as value_field,\n        count(*) as n_records\n\n    from bronze.users_cdc\n    group by op\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'c','u','d','r'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.572077Z", "completed_at": "2025-12-16T22:00:27.602034Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.618692Z", "completed_at": "2025-12-16T22:00:27.618700Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.11254525184631348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_accepted_values_bronze_matches_cdc_op__c__u__d__r.22ff3bce8d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        op as value_field,\n        count(*) as n_records\n\n    from bronze.matches_cdc\n    group by op\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'c','u','d','r'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.688348Z", "completed_at": "2025-12-16T22:00:27.727019Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.730351Z", "completed_at": "2025-12-16T22:00:27.730368Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0896444320678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_actions_cdc_target_id.0724930d2e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect target_id\nfrom bronze.actions_cdc\nwhere target_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.658456Z", "completed_at": "2025-12-16T22:00:27.714139Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.732735Z", "completed_at": "2025-12-16T22:00:27.732745Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1043100357055664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_actions_cdc_action.768cbb49cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect action\nfrom bronze.actions_cdc\nwhere action is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.668178Z", "completed_at": "2025-12-16T22:00:27.716359Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.734224Z", "completed_at": "2025-12-16T22:00:27.734232Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10239744186401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_actions_cdc_cdc_ts_ms.c43ad6811a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cdc_ts_ms\nfrom bronze.actions_cdc\nwhere cdc_ts_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.675375Z", "completed_at": "2025-12-16T22:00:27.721168Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.735882Z", "completed_at": "2025-12-16T22:00:27.735897Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09963059425354004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_actions_cdc_event_id.2f21bbb9e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom bronze.actions_cdc\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.679483Z", "completed_at": "2025-12-16T22:00:27.723188Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.737580Z", "completed_at": "2025-12-16T22:00:27.737591Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.09974884986877441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_actions_cdc_ingested_at.4878b5d4ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom bronze.actions_cdc\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.683969Z", "completed_at": "2025-12-16T22:00:27.725225Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.738806Z", "completed_at": "2025-12-16T22:00:27.738814Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.09952640533447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_actions_cdc_op.4ded02002c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect op\nfrom bronze.actions_cdc\nwhere op is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.692254Z", "completed_at": "2025-12-16T22:00:27.731236Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.742309Z", "completed_at": "2025-12-16T22:00:27.742317Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.10011100769042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_actions_cdc_user_id.45657fbe82", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom bronze.actions_cdc\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.698187Z", "completed_at": "2025-12-16T22:00:27.731470Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.743888Z", "completed_at": "2025-12-16T22:00:27.743896Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.09858250617980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_matches_cdc_cdc_ts_ms.d6a1b17696", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cdc_ts_ms\nfrom bronze.matches_cdc\nwhere cdc_ts_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.704225Z", "completed_at": "2025-12-16T22:00:27.733786Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.747074Z", "completed_at": "2025-12-16T22:00:27.747080Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.09892416000366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_matches_cdc_event_id.2717510402", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom bronze.matches_cdc\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.710568Z", "completed_at": "2025-12-16T22:00:27.750955Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.764561Z", "completed_at": "2025-12-16T22:00:27.764570Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.11488151550292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_matches_cdc_ingested_at.de0352e2c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom bronze.matches_cdc\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.783398Z", "completed_at": "2025-12-16T22:00:27.828519Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.849071Z", "completed_at": "2025-12-16T22:00:27.849079Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.09560775756835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_matches_cdc_op.60a4c2f278", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect op\nfrom bronze.matches_cdc\nwhere op is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.790723Z", "completed_at": "2025-12-16T22:00:27.830601Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.851200Z", "completed_at": "2025-12-16T22:00:27.851208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09436321258544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_matches_cdc_user1.0faf9a35eb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user1\nfrom bronze.matches_cdc\nwhere user1 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.796589Z", "completed_at": "2025-12-16T22:00:27.837341Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.862418Z", "completed_at": "2025-12-16T22:00:27.862426Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10087203979492188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_matches_cdc_user2.ef12d14811", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user2\nfrom bronze.matches_cdc\nwhere user2 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.800603Z", "completed_at": "2025-12-16T22:00:27.839641Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.866175Z", "completed_at": "2025-12-16T22:00:27.866182Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10333037376403809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_users_cdc_cdc_ts_ms.89c239f5d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cdc_ts_ms\nfrom bronze.users_cdc\nwhere cdc_ts_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.805718Z", "completed_at": "2025-12-16T22:00:27.846329Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.870513Z", "completed_at": "2025-12-16T22:00:27.870519Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10451984405517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_users_cdc_event_id.122f6aa437", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom bronze.users_cdc\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.809463Z", "completed_at": "2025-12-16T22:00:27.846671Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.872249Z", "completed_at": "2025-12-16T22:00:27.872256Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.10496878623962402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_users_cdc_id.eb8217b765", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom bronze.users_cdc\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.814656Z", "completed_at": "2025-12-16T22:00:27.849513Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.876348Z", "completed_at": "2025-12-16T22:00:27.876354Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.10664057731628418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_users_cdc_ingested_at.01c9e473ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom bronze.users_cdc\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.819169Z", "completed_at": "2025-12-16T22:00:27.850948Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.878554Z", "completed_at": "2025-12-16T22:00:27.878560Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.10720109939575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_users_cdc_op.e0858b2ee7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect op\nfrom bronze.users_cdc\nwhere op is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.824874Z", "completed_at": "2025-12-16T22:00:27.862847Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.886761Z", "completed_at": "2025-12-16T22:00:27.886767Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.11216616630554199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.source_not_null_bronze_users_cdc_user_id.d16fc9845f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom bronze.users_cdc\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.856948Z", "completed_at": "2025-12-16T22:00:27.899078Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.918015Z", "completed_at": "2025-12-16T22:00:27.918023Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.11369466781616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.dim_cities", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT DISTINCT\n        city AS city_name,\n        state_id AS state_name_id,   -- old code passed original ID\n        CAST(latitude AS DOUBLE) AS latitude,\n        CAST(longitude AS DOUBLE) AS longitude,\n        ingested_at\n    FROM bronze.users_cdc\n    WHERE city IS NOT NULL\n),\n\njoined AS (\n    SELECT\n        b.city_name,\n        st.state_id,        -- THE FIX (surrogate key)\n        b.latitude,\n        b.longitude,\n        b.ingested_at\n    FROM base b\n    LEFT JOIN silver.dim_states st\n        ON b.state_name_id = st.state_name_id\n),\n\nordered AS (\n    SELECT\n        city_name,\n        state_id,\n        MAX(ingested_at) AS last_ingested_at\n    FROM joined\n    GROUP BY city_name, state_id\n),\n\nwith_ids AS (\n    SELECT\n        ROW_NUMBER() OVER (ORDER BY state_id, city_name) AS city_id,\n        city_name,\n        state_id,\n        last_ingested_at\n    FROM ordered\n)\n\nSELECT *\nFROM with_ids", "relation_name": "silver.dim_cities", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.931669Z", "completed_at": "2025-12-16T22:00:27.980973Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:27.996693Z", "completed_at": "2025-12-16T22:00:27.996709Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.10259461402893066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_dim_states_state_id.9ea304f4bd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_id\nfrom silver.dim_states\nwhere state_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.942275Z", "completed_at": "2025-12-16T22:00:27.988216Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.000951Z", "completed_at": "2025-12-16T22:00:28.000959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10033726692199707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_dim_states_state_name.3d2ad66f4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_name\nfrom silver.dim_states\nwhere state_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.945990Z", "completed_at": "2025-12-16T22:00:27.989279Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.003136Z", "completed_at": "2025-12-16T22:00:28.003144Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10076689720153809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_dim_states_state_id.3adb7ee7db", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    state_id as unique_field,\n    count(*) as n_records\n\nfrom silver.dim_states\nwhere state_id is not null\ngroup by state_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.951969Z", "completed_at": "2025-12-16T22:00:27.994313Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.005513Z", "completed_at": "2025-12-16T22:00:28.005521Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0992746353149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.actions", "compiled": true, "compiled_code": "\n\nSELECT\n    user_id,\n    target_id,\n    action,\n    created_at AS action_at,\n    DATE(created_at) AS action_date\n\nFROM silver.fct_actions", "relation_name": "gold.actions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.959082Z", "completed_at": "2025-12-16T22:00:27.994716Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.007393Z", "completed_at": "2025-12-16T22:00:28.007400Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.09758758544921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_actions_action.be35fbc07c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect action\nfrom silver.fct_actions\nwhere action is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.963839Z", "completed_at": "2025-12-16T22:00:27.996346Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.015680Z", "completed_at": "2025-12-16T22:00:28.015689Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.10193657875061035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_actions_cdc_ts_ms.73751d9680", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cdc_ts_ms\nfrom silver.fct_actions\nwhere cdc_ts_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.955371Z", "completed_at": "2025-12-16T22:00:27.997407Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.019744Z", "completed_at": "2025-12-16T22:00:28.019751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.11165308952331543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.accepted_values_fct_actions_action__like__dislike.bac6ce34ab", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        action as value_field,\n        count(*) as n_records\n\n    from silver.fct_actions\n    group by action\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'like','dislike'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.969312Z", "completed_at": "2025-12-16T22:00:27.997713Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.022148Z", "completed_at": "2025-12-16T22:00:28.022158Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1062312126159668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_actions_event_id.b85fa910cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom silver.fct_actions\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:27.983367Z", "completed_at": "2025-12-16T22:00:28.017046Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.035645Z", "completed_at": "2025-12-16T22:00:28.035655Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.11188793182373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_actions_ingested_at_bronze.e89c1eba9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at_bronze\nfrom silver.fct_actions\nwhere ingested_at_bronze is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.008870Z", "completed_at": "2025-12-16T22:00:28.048616Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.064294Z", "completed_at": "2025-12-16T22:00:28.064302Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.08971619606018066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_actions_target_id.368f40c54f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect target_id\nfrom silver.fct_actions\nwhere target_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.071419Z", "completed_at": "2025-12-16T22:00:28.126997Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.141249Z", "completed_at": "2025-12-16T22:00:28.141263Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.10348987579345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_actions_user_id.e8ac3f89f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver.fct_actions\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.079285Z", "completed_at": "2025-12-16T22:00:28.130170Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.143583Z", "completed_at": "2025-12-16T22:00:28.143589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10000801086425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_fct_actions_user_id_target_id.d96e215509", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id || '-' || target_id as unique_field,\n    count(*) as n_records\n\nfrom silver.fct_actions\nwhere user_id || '-' || target_id is not null\ngroup by user_id || '-' || target_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.088002Z", "completed_at": "2025-12-16T22:00:28.130538Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.146990Z", "completed_at": "2025-12-16T22:00:28.146996Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09964108467102051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_matches_cdc_ts_ms.a5077bc7f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cdc_ts_ms\nfrom silver.fct_matches\nwhere cdc_ts_ms is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.083846Z", "completed_at": "2025-12-16T22:00:28.130835Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.149174Z", "completed_at": "2025-12-16T22:00:28.149182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10378384590148926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.matches", "compiled": true, "compiled_code": "\n\nSELECT\n    user1,\n    user2,\n    created_at AS matched_at,\n    DATE(created_at) AS matched_date\n\nFROM silver.fct_matches", "relation_name": "gold.matches", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.094124Z", "completed_at": "2025-12-16T22:00:28.136334Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.154131Z", "completed_at": "2025-12-16T22:00:28.154140Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1047828197479248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_matches_ingested_at_bronze.5687552ac8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at_bronze\nfrom silver.fct_matches\nwhere ingested_at_bronze is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.098726Z", "completed_at": "2025-12-16T22:00:28.137058Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.155415Z", "completed_at": "2025-12-16T22:00:28.155423Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.10427427291870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_matches_user1.70e6f67767", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user1\nfrom silver.fct_matches\nwhere user1 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.106477Z", "completed_at": "2025-12-16T22:00:28.148901Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.165379Z", "completed_at": "2025-12-16T22:00:28.165388Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10911846160888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_fct_matches_user2.364261f0f0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user2\nfrom silver.fct_matches\nwhere user2 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.111139Z", "completed_at": "2025-12-16T22:00:28.151013Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.170264Z", "completed_at": "2025-12-16T22:00:28.170271Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.11244440078735352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_fct_matches_user1_user2.f990ebe722", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user1 || '-' || user2 as unique_field,\n    count(*) as n_records\n\nfrom silver.fct_matches\nwhere user1 || '-' || user2 is not null\ngroup by user1 || '-' || user2\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.131507Z", "completed_at": "2025-12-16T22:00:28.169994Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.186480Z", "completed_at": "2025-12-16T22:00:28.186492Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.11708998680114746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_contact_ingested_at_bronze.d16cba78c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at_bronze\nfrom silver.users_contact\nwhere ingested_at_bronze is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.157072Z", "completed_at": "2025-12-16T22:00:28.191699Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.206596Z", "completed_at": "2025-12-16T22:00:28.206612Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.08529138565063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_contact_user_id.930e4dfdd4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver.users_contact\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.216882Z", "completed_at": "2025-12-16T22:00:28.269839Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.287247Z", "completed_at": "2025-12-16T22:00:28.287256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11004161834716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_metadata_ingested_at_bronze.d2aa7e1e25", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at_bronze\nfrom silver.users_metadata\nwhere ingested_at_bronze is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.210373Z", "completed_at": "2025-12-16T22:00:28.271802Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.289701Z", "completed_at": "2025-12-16T22:00:28.289708Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.11448383331298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_users_contact_user_id.6b12893dec", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver.users_contact\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.221252Z", "completed_at": "2025-12-16T22:00:28.272354Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.291963Z", "completed_at": "2025-12-16T22:00:28.291970Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.11210751533508301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_metadata_user_id.10f21493f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver.users_metadata\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.227120Z", "completed_at": "2025-12-16T22:00:28.275128Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.295948Z", "completed_at": "2025-12-16T22:00:28.295955Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11136293411254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_users_metadata_user_id.33505d5f14", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver.users_metadata\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.236410Z", "completed_at": "2025-12-16T22:00:28.277285Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.298146Z", "completed_at": "2025-12-16T22:00:28.298153Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.10784554481506348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_picture_ingested_at_bronze.f37ba6e252", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at_bronze\nfrom silver.users_picture\nwhere ingested_at_bronze is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.243930Z", "completed_at": "2025-12-16T22:00:28.285723Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.301789Z", "completed_at": "2025-12-16T22:00:28.301797Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.10983896255493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_picture_user_id.49e63bdf8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver.users_picture\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.253894Z", "completed_at": "2025-12-16T22:00:28.286288Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.303945Z", "completed_at": "2025-12-16T22:00:28.303952Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10483098030090332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_users_picture_user_id.3d918fe96d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver.users_picture\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.262541Z", "completed_at": "2025-12-16T22:00:28.293393Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.312732Z", "completed_at": "2025-12-16T22:00:28.312741Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.10975360870361328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.users", "compiled": true, "compiled_code": "\n\nWITH src AS (\n    SELECT *\n    FROM bronze.users_cdc\n),\n\nmapped AS (\n    SELECT\n        s.user_id,\n        s.gender,\n        s.first_name,\n        s.last_name,\n        st.state_id AS state_id,        -- surrogate\n        ct.city_id AS city_id,          -- surrogate\n        s.latitude,\n        s.longitude,\n        date_add('1970-01-01', s.dob_days) AS dob,\n        s.created_at,\n        s.ingested_at AS ingested_at_bronze\n    FROM src s\n    LEFT JOIN silver.dim_states st\n        ON s.state_id = st.state_name_id\n\n    LEFT JOIN silver.dim_cities ct\n        ON s.city = ct.city_name\n        AND st.state_id = ct.state_id \n)\n\nSELECT *\nFROM mapped", "relation_name": "silver.users", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.279563Z", "completed_at": "2025-12-16T22:00:28.321892Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.337513Z", "completed_at": "2025-12-16T22:00:28.337519Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.10556530952453613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_dim_cities_city_id.805f7885d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect city_id\nfrom silver.dim_cities\nwhere city_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.314998Z", "completed_at": "2025-12-16T22:00:28.351413Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.374549Z", "completed_at": "2025-12-16T22:00:28.374557Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.10174870491027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_dim_cities_city_name.d225d7e9f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect city_name\nfrom silver.dim_cities\nwhere city_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.369208Z", "completed_at": "2025-12-16T22:00:28.413120Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.432468Z", "completed_at": "2025-12-16T22:00:28.432477Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10163235664367676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.accepted_values_actions_action__like__dislike.e0e580766e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        action as value_field,\n        count(*) as n_records\n\n    from gold.actions\n    group by action\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'like','dislike'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.363853Z", "completed_at": "2025-12-16T22:00:28.413481Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.434612Z", "completed_at": "2025-12-16T22:00:28.434621Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.10541987419128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_dim_cities_city_id.1f84b1e3d7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    city_id as unique_field,\n    count(*) as n_records\n\nfrom silver.dim_cities\nwhere city_id is not null\ngroup by city_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.359304Z", "completed_at": "2025-12-16T22:00:28.416546Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.436683Z", "completed_at": "2025-12-16T22:00:28.436691Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10917544364929199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_dim_cities_state_id.1824d5344d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_id\nfrom silver.dim_cities\nwhere state_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.376082Z", "completed_at": "2025-12-16T22:00:28.416854Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.439121Z", "completed_at": "2025-12-16T22:00:28.439128Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10332059860229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_actions_action.01ae2944e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect action\nfrom gold.actions\nwhere action is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.381875Z", "completed_at": "2025-12-16T22:00:28.419449Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.441444Z", "completed_at": "2025-12-16T22:00:28.441451Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.10222864151000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_actions_action_at.399e6aa0cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect action_at\nfrom gold.actions\nwhere action_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.386367Z", "completed_at": "2025-12-16T22:00:28.423281Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.443797Z", "completed_at": "2025-12-16T22:00:28.443803Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.10282588005065918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_actions_action_date.d276bc0282", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect action_date\nfrom gold.actions\nwhere action_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.390730Z", "completed_at": "2025-12-16T22:00:28.430302Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.450085Z", "completed_at": "2025-12-16T22:00:28.450092Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.10744404792785645, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_actions_target_id.ac59510b84", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect target_id\nfrom gold.actions\nwhere target_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.400702Z", "completed_at": "2025-12-16T22:00:28.433175Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.454153Z", "completed_at": "2025-12-16T22:00:28.454160Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.10486888885498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_actions_user_id.54b2974b4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom gold.actions\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.426554Z", "completed_at": "2025-12-16T22:00:28.469468Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.488052Z", "completed_at": "2025-12-16T22:00:28.488063Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.10807609558105469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_matches_matched_at.430ad29dc0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect matched_at\nfrom gold.matches\nwhere matched_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.465842Z", "completed_at": "2025-12-16T22:00:28.505386Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.537420Z", "completed_at": "2025-12-16T22:00:28.537442Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.1139678955078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_matches_matched_date.ee3955bef9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect matched_date\nfrom gold.matches\nwhere matched_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.510067Z", "completed_at": "2025-12-16T22:00:28.552841Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.571518Z", "completed_at": "2025-12-16T22:00:28.571549Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09921050071716309, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_matches_user1.a47d6d6788", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user1\nfrom gold.matches\nwhere user1 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.516143Z", "completed_at": "2025-12-16T22:00:28.557414Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.573535Z", "completed_at": "2025-12-16T22:00:28.573555Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.09785223007202148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_matches_user2.e6130edf24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user2\nfrom gold.matches\nwhere user2 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.520263Z", "completed_at": "2025-12-16T22:00:28.560639Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.575655Z", "completed_at": "2025-12-16T22:00:28.575666Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0979299545288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_matchstream.dim_users", "compiled": true, "compiled_code": "\n\nWITH b AS (SELECT * FROM silver.users),\n     c AS (SELECT * FROM silver.users_contact),\n     p AS (SELECT * FROM silver.users_picture),\n     m AS (SELECT * FROM silver.users_metadata),\n     ci AS (SELECT * FROM silver.dim_cities),\n     st AS (SELECT * FROM silver.dim_states)\n\nSELECT\n    b.user_id,\n    b.gender,\n    b.first_name,\n    b.last_name,\n    FLOOR(DATEDIFF(current_date, b.dob) / 365) AS age,\n\n    -- Contact\n    c.phone,\n    c.cell,\n    c.email,\n\n    -- Pictures\n    p.picture_large,\n    p.picture_medium,\n    p.picture_thumbnail,\n\n    -- Geo (surrogate dimension values)\n    ci.city_name,\n    st.state_name,\n    st.state_name_id,\n\n    b.latitude,\n    b.longitude,\n\n    -- Metadata\n    m.created_at,\n    b.ingested_at_bronze\nFROM b\nLEFT JOIN c  ON b.user_id = c.user_id\nLEFT JOIN p  ON b.user_id = p.user_id\nLEFT JOIN m  ON b.user_id = m.user_id\nLEFT JOIN ci ON b.city_id = ci.city_id\nLEFT JOIN st ON b.state_id = st.state_id", "relation_name": "gold.dim_users", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.526262Z", "completed_at": "2025-12-16T22:00:28.566262Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.577498Z", "completed_at": "2025-12-16T22:00:28.577510Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09795045852661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_city_id.58d8a7ae8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect city_id\nfrom silver.users\nwhere city_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.530169Z", "completed_at": "2025-12-16T22:00:28.569196Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.579211Z", "completed_at": "2025-12-16T22:00:28.579219Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.09753155708312988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_ingested_at_bronze.1ebadd6ad8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at_bronze\nfrom silver.users\nwhere ingested_at_bronze is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.533988Z", "completed_at": "2025-12-16T22:00:28.570758Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.580928Z", "completed_at": "2025-12-16T22:00:28.580935Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.09715700149536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_state_id.9a3480c9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state_id\nfrom silver.users\nwhere state_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.538845Z", "completed_at": "2025-12-16T22:00:28.572673Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.583905Z", "completed_at": "2025-12-16T22:00:28.583913Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.09352254867553711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_users_user_id.fa10ab166c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver.users\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.543617Z", "completed_at": "2025-12-16T22:00:28.576174Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.588774Z", "completed_at": "2025-12-16T22:00:28.588784Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.09394049644470215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_users_user_id.dff2f1fba5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver.users\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.611158Z", "completed_at": "2025-12-16T22:00:28.629788Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.631995Z", "completed_at": "2025-12-16T22:00:28.632005Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.03485608100891113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_dim_users_user_id.e754bb5812", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom gold.dim_users\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.606286Z", "completed_at": "2025-12-16T22:00:28.631291Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.634017Z", "completed_at": "2025-12-16T22:00:28.634024Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.038475990295410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.not_null_dim_users_age.570f58a24f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect age\nfrom gold.dim_users\nwhere age is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-16T22:00:28.615429Z", "completed_at": "2025-12-16T22:00:28.633729Z"}, {"name": "execute", "started_at": "2025-12-16T22:00:28.637337Z", "completed_at": "2025-12-16T22:00:28.637344Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03847646713256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_matchstream.unique_dim_users_user_id.bcdc17b9f9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom gold.dim_users\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.7491462230682373, "args": {"compile": true, "favor_state": false, "partial_parse_file_diff": true, "macro_debugging": false, "require_nested_cumulative_type_params": false, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "static_parser": true, "defer": false, "populate_cache": true, "invocation_command": "dbt docs generate --project-dir /workspace", "log_level": "info", "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "/workspace", "strict_mode": false, "printer_width": 80, "log_path": "/workspace/logs", "send_anonymous_usage_stats": true, "state_modified_compare_vars": false, "version_check": true, "select": [], "which": "generate", "quiet": false, "static": false, "log_format": "default", "log_format_file": "debug", "vars": {}, "use_colors": true, "log_file_max_bytes": 10485760, "exclude": [], "profiles_dir": "/workspace", "require_batched_execution_for_custom_microbatch_strategy": false, "write_json": true, "require_yaml_configuration_for_mf_time_spines": false, "cache_selected_only": false, "empty_catalog": false, "introspect": true, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "print": true, "partial_parse": true, "log_level_file": "debug", "require_resource_names_without_spaces": false}}